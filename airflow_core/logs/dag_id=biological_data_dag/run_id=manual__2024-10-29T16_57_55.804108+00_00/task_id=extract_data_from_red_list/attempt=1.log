[2024-10-29T16:59:26.980+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-10-29T16:59:27.028+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: biological_data_dag.extract_data_from_red_list manual__2024-10-29T16:57:55.804108+00:00 [queued]>
[2024-10-29T16:59:27.052+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: biological_data_dag.extract_data_from_red_list manual__2024-10-29T16:57:55.804108+00:00 [queued]>
[2024-10-29T16:59:27.052+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2024-10-29T16:59:27.088+0000] {taskinstance.py:2888} INFO - Executing <Task(_PythonDecoratedOperator): extract_data_from_red_list> on 2024-10-29 16:57:55.804108+00:00
[2024-10-29T16:59:27.113+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=896) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-10-29T16:59:27.119+0000] {standard_task_runner.py:72} INFO - Started process 899 to run task
[2024-10-29T16:59:27.121+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'biological_data_dag', 'extract_data_from_red_list', 'manual__2024-10-29T16:57:55.804108+00:00', '--job-id', '121', '--raw', '--subdir', 'DAGS_FOLDER/biological_data_dag.py', '--cfg-path', '/tmp/tmpsx9whsj8']
[2024-10-29T16:59:27.123+0000] {standard_task_runner.py:105} INFO - Job 121: Subtask extract_data_from_red_list
[2024-10-29T16:59:27.264+0000] {task_command.py:467} INFO - Running <TaskInstance: biological_data_dag.extract_data_from_red_list manual__2024-10-29T16:57:55.804108+00:00 [running]> on host 8b409d8ad50e
[2024-10-29T16:59:27.523+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='biological_data_dag' AIRFLOW_CTX_TASK_ID='extract_data_from_red_list' AIRFLOW_CTX_EXECUTION_DATE='2024-10-29T16:57:55.804108+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-10-29T16:57:55.804108+00:00'
[2024-10-29T16:59:27.531+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-10-29T16:59:27.532+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-10-29T16:59:27.532+0000] {logging_mixin.py:190} INFO - Current task name:extract_data_from_red_list state:running start_date:2024-10-29 16:59:27.028971+00:00
[2024-10-29T16:59:27.532+0000] {logging_mixin.py:190} INFO - Dag name:biological_data_dag and current dag run status:running
[2024-10-29T16:59:27.533+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-10-29T16:59:28.903+0000] {logging_mixin.py:190} INFO - Species link https://www.iucnredlist.org/species/29691/115767606
[2024-10-29T17:00:36.833+0000] {logging_mixin.py:190} INFO - Species name: Ablepharus kitaibelii
[2024-10-29T17:00:36.888+0000] {logging_mixin.py:190} INFO - Common name: Juniper Skink
[2024-10-29T17:00:37.141+0000] {logging_mixin.py:190} INFO - Class: reptilia
[2024-10-29T17:00:37.212+0000] {logging_mixin.py:190} INFO - Order: squamata
[2024-10-29T17:00:37.302+0000] {logging_mixin.py:190} INFO - Family: scincidae
[2024-10-29T17:00:37.385+0000] {logging_mixin.py:190} INFO - Genus: ablepharus
[2024-10-29T17:00:37.434+0000] {logging_mixin.py:190} INFO - Conservation status: Least Concern 
[2024-10-29T17:00:37.515+0000] {logging_mixin.py:190} INFO - Habitat type: Terrestrial
[2024-10-29T17:00:37.516+0000] {logging_mixin.py:190} INFO - ----------------------------------------
[2024-10-29T17:00:37.516+0000] {logging_mixin.py:190} INFO - species to store [{'species': 'Ablepharus kitaibelii', 'common_name': 'Juniper Skink', 'class_red_list': 'reptilia', 'order_red_list': 'squamata', 'family_red_list': 'scincidae', 'genus_red_list': 'ablepharus', 'conservation_status': 'Least Concern ', 'habitat_type': 'Terrestrial'}]
[2024-10-29T17:00:38.721+0000] {logging_mixin.py:190} INFO - Species link https://www.iucnredlist.org/species/22725044/155292529
[2024-10-29T17:00:43.677+0000] {logging_mixin.py:190} INFO - Species name: Acanthis flammea
[2024-10-29T17:00:43.767+0000] {logging_mixin.py:190} INFO - Common name: Redpoll
[2024-10-29T17:00:44.229+0000] {logging_mixin.py:190} INFO - Class: aves
[2024-10-29T17:00:44.368+0000] {logging_mixin.py:190} INFO - Order: passeriformes
[2024-10-29T17:00:44.483+0000] {logging_mixin.py:190} INFO - Family: fringillidae
[2024-10-29T17:00:44.661+0000] {logging_mixin.py:190} INFO - Genus: acanthis
[2024-10-29T17:00:44.751+0000] {logging_mixin.py:190} INFO - Conservation status: Least Concern 
[2024-10-29T17:00:44.948+0000] {logging_mixin.py:190} INFO - Habitat type: Terrestrial
[2024-10-29T17:00:44.949+0000] {logging_mixin.py:190} INFO - ----------------------------------------
[2024-10-29T17:00:44.950+0000] {logging_mixin.py:190} INFO - species to store [{'species': 'Acanthis flammea', 'common_name': 'Redpoll', 'class_red_list': 'aves', 'order_red_list': 'passeriformes', 'family_red_list': 'fringillidae', 'genus_red_list': 'acanthis', 'conservation_status': 'Least Concern ', 'habitat_type': 'Terrestrial'}]
[2024-10-29T17:00:46.299+0000] {logging_mixin.py:190} INFO - Species link https://www.iucnredlist.org/species/76/97260200
[2024-10-29T17:04:50.473+0000] {logging_mixin.py:190} INFO - Species name: Acanthochelys spixii
[2024-10-29T17:04:50.573+0000] {logging_mixin.py:190} INFO - Common name: Black Spiny-necked Swamp Turtle
[2024-10-29T17:04:50.788+0000] {logging_mixin.py:190} INFO - Class: reptilia
[2024-10-29T17:04:50.829+0000] {logging_mixin.py:190} INFO - Order: testudines
[2024-10-29T17:04:50.867+0000] {logging_mixin.py:190} INFO - Family: chelidae
[2024-10-29T17:04:50.901+0000] {logging_mixin.py:190} INFO - Genus: acanthochelys
[2024-10-29T17:04:50.928+0000] {logging_mixin.py:190} INFO - Conservation status: Lower Risk/near threatened 
[2024-10-29T17:04:50.978+0000] {logging_mixin.py:190} INFO - Habitat type: Terrestrial
[2024-10-29T17:04:50.979+0000] {logging_mixin.py:190} INFO - ----------------------------------------
[2024-10-29T17:04:50.979+0000] {logging_mixin.py:190} INFO - species to store [{'species': 'Acanthochelys spixii', 'common_name': 'Black Spiny-necked Swamp Turtle', 'class_red_list': 'reptilia', 'order_red_list': 'testudines', 'family_red_list': 'chelidae', 'genus_red_list': 'acanthochelys', 'conservation_status': 'Lower Risk/near threatened ', 'habitat_type': 'Terrestrial'}]
[2024-10-29T17:04:51.855+0000] {logging_mixin.py:190} INFO - Species link https://www.iucnredlist.org/species/61456/12470495
[2024-10-29T17:04:56.132+0000] {local_task_job_runner.py:346} WARNING - State of this instance has been externally set to restarting. Terminating instance.
[2024-10-29T17:04:56.133+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-10-29T17:04:56.136+0000] {process_utils.py:132} INFO - Sending 15 to group 899. PIDs of all processes in the group: [1429, 1435, 1454, 1455, 1476, 1492, 1533, 1558, 1475, 899]
[2024-10-29T17:04:56.136+0000] {process_utils.py:87} INFO - Sending the signal 15 to group 899
[2024-10-29T17:04:56.137+0000] {taskinstance.py:3092} ERROR - Received SIGTERM. Terminating subprocesses.
[2024-10-29T17:04:56.144+0000] {connectionpool.py:870} WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectionResetError(104, 'Connection reset by peer')': /session/46f2a42012611d6da86b94bdabb7657a
[2024-10-29T17:04:56.147+0000] {connectionpool.py:870} WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7017b55a6c60>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/46f2a42012611d6da86b94bdabb7657a
[2024-10-29T17:04:56.149+0000] {connectionpool.py:870} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7017b55a6cf0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/46f2a42012611d6da86b94bdabb7657a
[2024-10-29T17:04:56.164+0000] {taskinstance.py:3310} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/decorators/base.py", line 266, in execute
    return_value = super().execute(context)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/biological_data_dag.py", line 306, in extract_data_from_red_list
    driver.get(link)
  File "/home/airflow/.local/lib/python3.12/site-packages/selenium/webdriver/remote/webdriver.py", line 363, in get
    self.execute(Command.GET, {"url": url})
  File "/home/airflow/.local/lib/python3.12/site-packages/selenium/webdriver/remote/webdriver.py", line 352, in execute
    response = self.command_executor.execute(driver_command, params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/selenium/webdriver/remote/remote_connection.py", line 306, in execute
    return self._request(command_info[0], url, body=data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/selenium/webdriver/remote/remote_connection.py", line 326, in _request
    response = self._conn.request(method, url, body=body, headers=headers)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/_request_methods.py", line 144, in request
    return self.request_encode_body(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/_request_methods.py", line 279, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py", line 464, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/usr/local/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3094, in signal_handler
    raise AirflowTaskTerminated("Task received SIGTERM signal")
airflow.exceptions.AirflowTaskTerminated: Task received SIGTERM signal
[2024-10-29T17:04:56.178+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-10-29T17:04:56.178+0000] {logging_mixin.py:190} INFO - Task start:2024-10-29 16:59:27.028971+00:00 end:2024-10-29 17:04:56.177890+00:00 duration:329.148919
[2024-10-29T17:04:56.179+0000] {logging_mixin.py:190} INFO - Task:<Task(_PythonDecoratedOperator): extract_data_from_red_list> dag:<DAG: biological_data_dag> dagrun:<DagRun biological_data_dag @ 2024-10-29 16:57:55.804108+00:00: manual__2024-10-29T16:57:55.804108+00:00, state:running, queued_at: 2024-10-29 16:57:55.830121+00:00. externally triggered: True>
[2024-10-29T17:04:56.179+0000] {logging_mixin.py:190} INFO - Failure caused by Task received SIGTERM signal
[2024-10-29T17:04:56.179+0000] {taskinstance.py:1225} INFO - Marking task as UP_FOR_RETRY. dag_id=biological_data_dag, task_id=extract_data_from_red_list, run_id=manual__2024-10-29T16:57:55.804108+00:00, execution_date=20241029T165755, start_date=20241029T165927, end_date=20241029T170456
[2024-10-29T17:04:56.195+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-10-29T17:04:56.196+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1455, status='terminated', started='17:04:50') (1455) terminated with exit code None
[2024-10-29T17:04:56.197+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1429, status='terminated', started='17:04:50') (1429) terminated with exit code None
[2024-10-29T17:04:56.197+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1558, status='terminated', started='17:04:54') (1558) terminated with exit code None
[2024-10-29T17:04:56.198+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1533, status='terminated', started='17:04:51') (1533) terminated with exit code None
[2024-10-29T17:04:56.212+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=899, status='terminated', exitcode=2, started='16:59:26') (899) terminated with exit code 2
[2024-10-29T17:04:56.212+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1435, status='terminated', started='17:04:50') (1435) terminated with exit code None
[2024-10-29T17:04:56.213+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1476, status='terminated', started='17:04:50') (1476) terminated with exit code None
[2024-10-29T17:04:56.213+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1492, status='terminated', started='17:04:50') (1492) terminated with exit code None
[2024-10-29T17:04:56.213+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1475, status='terminated', started='17:04:50') (1475) terminated with exit code None
[2024-10-29T17:04:56.214+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1454, status='terminated', started='17:04:50') (1454) terminated with exit code None
